// malware.c
#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/types.h>
#include <unistd.h>

int main(int argc, char **argv) {
  uid_t target = 1000;

  printf("Malware test process started. PID: %d, trying setuid(%u) every 5s\n",
         getpid(), (unsigned)target);

  for (int i = 0; i < 30; ++i) {
    uid_t ruid = getuid();
    uid_t euid = geteuid();

    setuid(target);
    printf("<malware>: ruid=%u euid=%u\n", (unsigned)ruid, (unsigned)euid);

    sleep(5);
  }

  printf("Malware test process exiting.\n");
  return 0;
}
